@model DiagnosticCenter.Models.ReferralVM
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@{
    ViewBag.Controller = "Patients";
    ViewBag.Action = "Patients.Create";
}
<script type="text/javascript">
    $(document).ready(function () {
        $("#Dept").change(function () {

            var url = '@Url.Content("~/")' + "Referral/Cabinet";
            var ddlsource = "#Dept";
            var ddltarget = "#Cab";
            $("#Empl").attr("disabled", "disabled");
            $("#Empl option[value='0']").attr("selected", "true");
            $.getJSON(url, { deptName: $(ddlsource).val() }, function (data) {
                $(ddltarget).empty();
                $.each(data, function (index, optionData) {
                    $(ddltarget).append("<option value='" + optionData.Value + "'>" + optionData.Text + "</option>");
                });

            });
        });


        $("#Cab").change(function () {
            var url = '@Url.Content("~/")' + "Referral/Employee";
            var ddlsource = "#Cab";
            var ddltarget = "#Empl";
            $("#Empl").attr("disabled", "");
            $.getJSON(url, { cabName: $(ddlsource).val() }, function (data) {
                $(ddltarget).empty();
                $.each(data, function (index, optionData) {
                    $(ddltarget).append("<option value='" + optionData.Value + "'>" + optionData.Text + "</option>");
                });

            });
           
        });

        $("#Cab").change(function () {
            var source = "#Cab";
            if ($(source).val() == "0" || $("#Empl").val() == "0") { $("#sub").attr("disabled", "disabled"); }
            else $("#sub").attr("disabled", "");
        });

        $("#Empl").change(function () {
            var source = "#Empl";
            if ($(source).val() == "0") { $("#sub").attr("disabled", "disabled"); }
            else $("#sub").attr("disabled", "");
        });
    });
  </script>
  
  @using (Html.BeginForm())
  {
     @Html.ValidationSummary(true) 
<h2>Index</h2>
<p>
    @Html.HiddenFor(item => item.patient)
    @Html.Label(ReferralRes.ReferralStrings.Patient)
    @Html.DisplayFor(item => item.patient)
</p>
<p>
    @Html.Label(ReferralRes.ReferralStrings.Department)
    @Html.DropDownList("Dept", Model.department)
    
</p>
<p>
    @Html.Label(ReferralRes.ReferralStrings.Cabinet)
    @Html.DropDownList("Cab", Model.cabinet)
</p>
<p>
    @Html.Label(ReferralRes.ReferralStrings.Doctor)
    @Html.DropDownList("Empl", Model.employee)
</p>
<p>@Html.Label(ReferralRes.ReferralStrings.VisitDate)
   @Html.TextBoxFor(item => item.visitDate)
   @Html.ValidationMessageFor(item => item.visitDate)
</p>
<p>@Html.Label(ReferralRes.ReferralStrings.CreationDate)
   @Html.DisplayFor(item => item.todayDate)
   @Html.HiddenFor(item => item.todayDate)
</p>
<p>
    <input type="submit" value=@ReferralRes.ReferralStrings.Print id="sub" disabled="disabled" />
</p>
      @Html.Hidden("idp",ViewData["IDP"])
  }